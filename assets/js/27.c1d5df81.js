(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{602:function(s,n,e){"use strict";e.r(n);var a=e(1),r=Object(a.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"spring-cloud-微服务构建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spring-cloud-微服务构建"}},[s._v("#")]),s._v(" Spring cloud 微服务构建")]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("微服务项目git地址")]),s._v("：\n"),e("a",{attrs:{href:"https://github.com/cainiao-wu/microservice-spring-cloud.git",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/cainiao-wu/microservice-spring-cloud.git"),e("OutboundLink")],1)]),s._v(" "),e("p",[e("strong",[s._v("服务配置文件git地址：")]),s._v(" "),e("a",{attrs:{href:"https://github.com/cainiao-wu/spring-config.git",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/cainiao-wu/spring-config.git"),e("OutboundLink")],1)])]),s._v(" "),e("hr"),s._v(" "),e("h2",{attrs:{id:"高可用的服务注册中心"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#高可用的服务注册中心"}},[s._v("#")]),s._v(" 高可用的服务注册中心")]),s._v(" "),e("h3",{attrs:{id:"创建-服务注册中心"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建-服务注册中心"}},[s._v("#")]),s._v(" 创建“服务注册中心”")]),s._v(" "),e("h4",{attrs:{id:"构建项目依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建项目依赖"}},[s._v("#")]),s._v(" 构建项目依赖")]),s._v(" "),e("p",[s._v("创建一个基础的"),e("code",[s._v("Spring Boot")]),s._v("项目，在"),e("code",[s._v("pom.xml")]),s._v(" 中引入需要的依赖内容：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-eureka-server</artifactId>\n</dependency>\n\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-test</artifactId>\n\t<scope>test</scope>\n</dependency>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("p",[s._v("通过@EnableEurekaServer注解启动一个服务注册中心提供给其他应用进行对话。")]),s._v(" "),e("h4",{attrs:{id:"配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[s._v("#")]),s._v(" 配置文件")]),s._v(" "),e("p",[s._v("未实现高可用行配置：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("spring:\n  application:\n    name: register-server\neureka:\n  instance:\n    hostname: localhost\n    prefer-ip-address: true\n  client:\n    //禁止将自己作为客户端注册\n    registerWithEureka: false  // 默认true\n    fetchRegistry: false // 默认true\n    serviceUrl:\n      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/\n  server:\n    enable-self-preservation: false\nserver:\n  port: ${PORT:8761}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("p",[s._v("实现高可用性的配置：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("server:\n  port: 8761\nspring:\n  profiles: peer1\n  application:\n    name: register-server\neureka:\n  instance:\n    hostname: peer1\n    prefer-ip-address: true\n  client:\n    serviceUrl:\n      defaultZone: http://localhost:8761/eureka/\n---\nserver:\n  port: 8762\nspring:\n  profiles: peer2\n  application:\n    name: register-server\neureka:\n  instance:\n    hostname: peer2\n    prefer-ip-address: true\n  client:\n    serviceUrl:\n      defaultZone: http://localhost:8761/eureka/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br")])]),e("h4",{attrs:{id:"启动项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动项目"}},[s._v("#")]),s._v(" 启动项目")]),s._v(" "),e("p",[s._v("通过配置不同的"),e("code",[s._v("spring.profiles.active")]),s._v("属性("),e("code",[s._v("peer1")]),s._v("/"),e("code",[s._v("peer2")]),s._v(")来启动注册中心\n"),e("img",{attrs:{src:"https://github.com/cainiao-wu/picture/raw/master/Spring%20cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA/spring-profiles-active.png",alt:"image"}}),s._v(" "),e("img",{attrs:{src:"https://github.com/cainiao-wu/picture/raw/master/Spring%20cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA/%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83.png",alt:"image"}})]),s._v(" "),e("h4",{attrs:{id:"深入理解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#深入理解"}},[s._v("#")]),s._v(" 深入理解")]),s._v(" "),e("p",[s._v("Eureka Server的同步遵循着一个非常简单的原则：只要有一条边将节点连接，就可以进行信息传播与同步。\n"),e("img",{attrs:{src:"https://github.com/cainiao-wu/picture/raw/master/Spring%20cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA/%E9%AB%98%E5%8F%AF%E7%94%A8%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83.png",alt:"image"}})]),s._v(" "),e("hr"),s._v(" "),e("h2",{attrs:{id:"高可用的分布式配置中心"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#高可用的分布式配置中心"}},[s._v("#")]),s._v(" 高可用的分布式配置中心")]),s._v(" "),e("h3",{attrs:{id:"构建config-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建config-server"}},[s._v("#")]),s._v(" 构建Config Server")]),s._v(" "),e("h4",{attrs:{id:"pom-xml依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pom-xml依赖"}},[s._v("#")]),s._v(" "),e("code",[s._v("pom.xml")]),s._v("依赖")]),s._v(" "),e("p",[e("code",[s._v("pom.xml")]),s._v("中引入"),e("code",[s._v("spring-cloud-config-server")]),s._v(","),e("code",[s._v("spring-cloud-starter-eureka")]),s._v("依赖，完整依赖配置如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-config-server</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-eureka</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-test</artifactId>\n\t<scope>test</scope>\n</dependency>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("h4",{attrs:{id:"添加-enableconfigserver注解，开启config-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加-enableconfigserver注解，开启config-server"}},[s._v("#")]),s._v(" 添加@EnableConfigServer注解，开启Config Server")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("@SpringBootApplication\n@EnableConfigServer\n@EnableEurekaClient\npublic class ConfigServerApplication {\n\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(ConfigServerApplication.class, args);\n\t}\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"application-yml中配置服务信息以及git信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#application-yml中配置服务信息以及git信息"}},[s._v("#")]),s._v(" "),e("code",[s._v("application.yml")]),s._v("中配置服务信息以及git信息")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("spring:\n  application:\n    name: config-server\n  cloud:\n    config:\n      enabled: true\n      server:\n        git:\n          uri: ${CONFIG_URL:https://github.com/cainiao-wu/spring-config.git}\n          search-paths: '{profile}'\n          username: cainiao-wu\n          password: wu58164023\n        bootstrap: true\nserver:\n  port: ${PORT:8888}\neureka:\n  client:\n    serviceUrl:\n      defaultZone: ${REGISTER_SERVER_URL:http://localhost:8761/eureka/,http://localhost:8762/eureka/}\n  instance:\n    prefer-ip-address: true\n    hostname: config-server\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("ul",[e("li",[s._v("spring.cloud.config.server.git.uri：配置git仓库位置")]),s._v(" "),e("li",[s._v("spring.cloud.config.server.git.searchPaths：配置仓库路径下的相对搜索位置，可以配置多个")]),s._v(" "),e("li",[s._v("spring.cloud.config.server.git.username：访问git仓库的用户名")]),s._v(" "),e("li",[s._v("spring.cloud.config.server.git.password：访问git仓库的用户密码")])]),s._v(" "),e("blockquote",[e("p",[e("code",[s._v("Spring Cloud Config")]),s._v("也提供本地存储配置的方式。我们只需要设置属性"),e("code",[s._v("spring.profiles.active=native")]),s._v(","),e("code",[s._v("ConfigServer")]),s._v("会默认从应用的"),e("code",[s._v("src/main/resource")]),s._v("目录下检索配置文件。也可以通过"),e("code",[s._v("spring.cloud.config.server.native.searchLocations=file:F:/properties/")]),s._v("属性来指定配置文件的位置。虽然"),e("code",[s._v("Spring Cloud Config")]),s._v("提供了这样的功能，但是为了支持更好的管理内容和版本控制的功能，还是推荐使用git的方式")])]),s._v(" "),e("h4",{attrs:{id:"url与配置文件的映射关系如下："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#url与配置文件的映射关系如下："}},[s._v("#")]),s._v(" URL与配置文件的映射关系如下：")]),s._v(" "),e("ul",[e("li",[s._v("/{application}/{profile}[/{label}]")]),s._v(" "),e("li",[s._v("/{application}-{profile}.yml")]),s._v(" "),e("li",[s._v("/{label}/{application}-{profile}.yml")]),s._v(" "),e("li",[s._v("/{application}-{profile}.properties")]),s._v(" "),e("li",[s._v("/{label}/{application}-{profile}.properties")])]),s._v(" "),e("blockquote",[e("p",[s._v("上面的url会映射{application}-{profile}.properties对应的配置文件，{label}对应git上不同的分支，默认为master")])]),s._v(" "),e("h3",{attrs:{id:"高可用问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#高可用问题"}},[s._v("#")]),s._v(" 高可用问题")]),s._v(" "),e("h4",{attrs:{id:"传统做法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#传统做法"}},[s._v("#")]),s._v(" 传统做法")]),s._v(" "),e("blockquote",[e("p",[s._v("通常在生产环境，Config Server与服务注册中心一样，我们也需要将其扩展为高可用的集群。在之前实现的config-server基础上来实现高可用非常简单，不需要我们为这些服务端做任何额外的配置，只需要遵守一个配置规则：将所有的Config Server都指向同一个Git仓库，这样所有的配置内容就通过统一的共享文件系统来维护，而客户端在指定Config Server位置时，只要配置Config Server外的均衡负载即可，就像如下图所示的结构")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://github.com/cainiao-wu/picture/raw/master/Spring%20cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA/config-server.png",alt:"image"}})]),s._v(" "),e("h4",{attrs:{id:"注册为服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#注册为服务"}},[s._v("#")]),s._v(" 注册为服务")]),s._v(" "),e("blockquote",[e("p",[s._v("虽然通过服务端负载均衡已经能够实现，但是作为架构内的配置管理，本身其实也是可以看作架构中的一个微服务。所以，另外一种方式更为简单的方法就是把config-server也注册为服务，这样所有客户端就能以服务的方式进行访问。通过这种方法，只需要启动多个指向同一Git仓库位置的config-server就能实现高可用了。")])]),s._v(" "),e("hr"),s._v(" "),e("h2",{attrs:{id:"构建spring-test-service微服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建spring-test-service微服务"}},[s._v("#")]),s._v(" 构建"),e("code",[s._v("spring-test-service")]),s._v("微服务")]),s._v(" "),e("h3",{attrs:{id:"添加项目所需依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加项目所需依赖"}},[s._v("#")]),s._v(" 添加项目所需依赖")]),s._v(" "),e("h4",{attrs:{id:"pom-xml中完整依赖配置如下："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pom-xml中完整依赖配置如下："}},[s._v("#")]),s._v(" "),e("code",[s._v("pom.xml")]),s._v("中完整依赖配置如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<dependency>\n\t<groupId>com.github.pagehelper</groupId>\n\t<artifactId>pagehelper-spring-boot-starter</artifactId>\n\t<version>1.1.0</version>\n</dependency>\n<dependency>\n\t<groupId>org.hibernate.javax.persistence</groupId>\n\t<artifactId>hibernate-jpa-2.1-api</artifactId>\n\t<version>1.0.0.Final</version>\n</dependency>\n\n\x3c!--<dependency>--\x3e\n\t\x3c!--<groupId>org.springframework.boot</groupId>--\x3e\n\t\x3c!--<artifactId>spring-boot-devtools</artifactId>--\x3e\n\t\x3c!--<scope>runtime</scope>--\x3e\n\x3c!--</dependency>--\x3e\n\x3c!--<dependency>--\x3e\n\t\x3c!--<groupId>org.springframework.cloud</groupId>--\x3e\n\t\x3c!--<artifactId>spring-cloud-stream</artifactId>--\x3e\n\t\x3c!--<version>1.2.2.RELEASE</version>--\x3e\n\x3c!--</dependency>--\x3e\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n\n<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-config</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-eureka</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-jdbc</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n\x3c!-- swagger-ui --\x3e\n<dependency>\n\t<groupId>io.springfox</groupId>\n\t<artifactId>springfox-swagger2</artifactId>\n\t<version>2.6.1</version>\n</dependency>\n<dependency>\n\t<groupId>io.springfox</groupId>\n\t<artifactId>springfox-swagger-ui</artifactId>\n\t<version>2.6.1</version>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n<dependency>\n\t<groupId>mysql</groupId>\n\t<artifactId>mysql-connector-java</artifactId>\n\t<scope>runtime</scope>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-test</artifactId>\n\t<scope>test</scope>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-data-mongodb</artifactId>\n\t<version>1.5.2.RELEASE</version>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-bus-amqp</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n<dependency>\n\t<groupId>net.sf.json-lib</groupId>\n\t<artifactId>json-lib</artifactId>\n\t<version>2.4</version>\n\t<classifier>jdk15</classifier>\n</dependency>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br")])]),e("h4",{attrs:{id:"本地application-yml配置内容如下："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#本地application-yml配置内容如下："}},[s._v("#")]),s._v(" 本地"),e("code",[s._v("application.yml")]),s._v("配置内容如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("spring:\n  application:\n    name: spring-test-service\n  cloud:\n    config:\n      name: spring-test-service\n      discovery:\n        service-id: config-server\n        enabled: true\n      fail-fast: true\n      retry:\n        maxAttempts: 32\n        multiplier: 1.5\n        maxInterval: 10000\neureka:\n  client:\n    serviceUrl:\n      defaultZone: ${REGISTER_SERVER_URL:http://localhost:8761/eureka/,http://localhost:8762/eureka/}\n  instance:\n    prefer-ip-address: true\n    hostname: spring-test-service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("h4",{attrs:{id:"git仓库配置中心内容："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#git仓库配置中心内容："}},[s._v("#")]),s._v(" git仓库配置中心内容：")]),s._v(" "),e("p",[e("code",[s._v("spring-test-service.yml")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("server:\n  port: ${PORT:8089}\nspring:\n  cloud:\n    stream:\n      bindings:\n        springCloudBusInput:\n          group: spring-test-service\n  datasource:\n      url: jdbc:mysql://localhost:3306/dev-gamepacket?characterEncoding=UTF-8&autoReconnect=true&failOverReadOnly=false&maxReconnects=5\n      username: ${MYSQL_USER:root}\n      password: ${MYSQL_PWD:123456}\n      driver-class-name: com.mysql.jdbc.Driver\npagehelper:\n  row-bounds-with-count: true\n  auto-dialect: true\n  reasonable: false\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("p",[e("code",[s._v("application.yml")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("spring:\n  mvc:\n    servlet:\n      load-on-startup: 1\n  rabbitmq:\n    host: ${RABBIT_HOST:rabbitmq}\n    port: ${RABBIT_PORT:5672}\n  redis:\n    host: ${REDIS_HOST:localhost} # Redis服务器地址\n    port: ${REDIS_PORT:6379}      # Redis服务器连接端口\n    database: ${REDIS_DATABASE:1} # Redis数据库索引（默认为0）\n#    password:                     # Redis服务器连接密码（默认为空）\n#    pool:\n#      max-active: 8               # 连接池最大连接数（使用负值表示没有限制）\n#      max-wait: -1                # 连接池最大阻塞等待时间（使用负值表示没有限制）\n#      max-idle: 8                 # 连接池中的最大空闲连接\n#      min-idle: 0                 # 连接池中的最小空闲连接\n#    timeout: 0                    # 连接超时时间（毫秒）\n  data:\n    mongodb:\n      uri: ${MONGO_URL:mongodb://localhost:27017/local}\nhystrix:\n  command:\n    default:\n      execution:\n        timeout:\n          enabled: false\n        isolation:\n          thread:\n            timeoutInMilliseconds: 600000\nlogging:\n  level:\n    java.sql: debug\n    com.hand.spring: debug\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br")])]),e("h3",{attrs:{id:"同一的异常处理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#同一的异常处理"}},[s._v("#")]),s._v(" 同一的异常处理")]),s._v(" "),e("h4",{attrs:{id:"spring-boot提供的默认error映射页面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot提供的默认error映射页面"}},[s._v("#")]),s._v(" "),e("code",[s._v("Spring Boot")]),s._v("提供的默认"),e("code",[s._v("error")]),s._v("映射页面")]),s._v(" "),e("p",[e("code",[s._v("Spring Boot")]),s._v("提供了一个默认的映射："),e("code",[s._v("/error")]),s._v("，当处理中抛出异常之后，会转到该请求中处理，并且该请求有一个全局的错误页面用来展示异常内容\n"),e("img",{attrs:{src:"https://github.com/cainiao-wu/picture/raw/master/Spring%20cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA/error.png",alt:"image"}})]),s._v(" "),e("h3",{attrs:{id:"异常处理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#异常处理"}},[s._v("#")]),s._v(" 异常处理")]),s._v(" "),e("ul",[e("li",[s._v("创建全局异常处理类：通过使用"),e("code",[s._v("@ControllerAdvice")]),s._v("定义统一的异常处理类，而不是在每个"),e("code",[s._v("Controller")]),s._v("中逐个定义。"),e("code",[s._v("@ExceptionHandler")]),s._v("用来定义函数针对的异常类型，在"),e("code",[s._v("@ExceptionHandler")]),s._v("之后加入"),e("code",[s._v("@ResponseBody")]),s._v("，就能让处理函数"),e("code",[s._v("return")]),s._v("的内容转换为JSON格式")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@RestControllerAdvice\npublic class CommonExceptionHandler {\n    private static final String SYS_EXCEPTION_CODE = "000000";\n    private Logger logger = LoggerFactory.getLogger(CommonExceptionHandler.class);\n\n    public CommonExceptionHandler() {\n    }\n\n    @ExceptionHandler({Exception.class})\n    @ResponseBody\n    public ErrorInfo<String> exceptionHandler(Exception exception, HttpServletRequest request, HttpServletResponse response) {\n        this.logger.error("请求失败", exception);\n        ErrorInfo<String> r = new ErrorInfo<>();\n        if (exception instanceof TestException) {\n            r.setMessage(exception.getMessage());\n            r.setCode(ErrorInfo.ERROR);\n            r.setData("TestException Data");\n            r.setUrl(request.getRequestURL().toString());\n        }else {\n            r.setMessage(exception.getMessage());\n            r.setCode(ErrorInfo.ERROR);\n            r.setData("Some Data");\n            r.setUrl(request.getRequestURL().toString());\n        }\n        return r;\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br")])]),e("h3",{attrs:{id:"使用swagger2构建强大的restful-api文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用swagger2构建强大的restful-api文档"}},[s._v("#")]),s._v(" 使用"),e("code",[s._v("Swagger2")]),s._v("构建强大的"),e("code",[s._v("RESTful API")]),s._v("文档")]),s._v(" "),e("h4",{attrs:{id:"添加swagger2依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加swagger2依赖"}},[s._v("#")]),s._v(" 添加"),e("code",[s._v("Swagger2")]),s._v("依赖")]),s._v(" "),e("p",[s._v("在"),e("code",[s._v("pom.xml")]),s._v("中加入"),e("code",[s._v("Swagger2")]),s._v("的依赖")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<dependency>\n\t<groupId>io.springfox</groupId>\n\t<artifactId>springfox-swagger2</artifactId>\n\t<version>2.6.1</version>\n</dependency>\n<dependency>\n\t<groupId>io.springfox</groupId>\n\t<artifactId>springfox-swagger-ui</artifactId>\n\t<version>2.6.1</version>\n</dependency>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"创建swagger2配置类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建swagger2配置类"}},[s._v("#")]),s._v(" 创建"),e("code",[s._v("Swagger2")]),s._v("配置类")]),s._v(" "),e("p",[s._v("在"),e("code",[s._v("Application.java")]),s._v("同级创建"),e("code",[s._v("Swagger2")]),s._v("的配置"),e("code",[s._v("类Swagger2")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@Configuration\n@EnableSwagger2\npublic class Swagger2 {\n\n    @Bean\n    public Docket createRestApi() {\n        return new Docket(DocumentationType.SWAGGER_2)\n                .apiInfo(apiInfo())\n                .select()\n                .apis(RequestHandlerSelectors.basePackage("com.hand"))\n                .paths(PathSelectors.any())\n                .build();\n    }\n\n    private ApiInfo apiInfo() {\n        return new ApiInfoBuilder()\n                .title("Spring Boot中使用Swagger2构建RESTful APIs")\n                .description("Spring Boot中使用Swagger2构建RESTful APIs")\n                .termsOfServiceUrl("http://www.baidu.com/")\n                .contact("cainiao-wu")\n                .version("1.0")\n                .build();\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br")])]),e("blockquote",[e("p",[s._v("如上代码所示，通过"),e("code",[s._v("@Configuration")]),s._v("注解，让"),e("code",[s._v("Spring")]),s._v("来加载该类配置。再通过"),e("code",[s._v("@EnableSwagger2")]),s._v("注解来启用"),e("code",[s._v("Swagger2")]),s._v("。")]),s._v(" "),e("p",[s._v("再通过"),e("code",[s._v("createRestApi")]),s._v("函数创建"),e("code",[s._v("Docket的Bean")]),s._v("之后，"),e("code",[s._v("apiInfo()")]),s._v("用来创建该"),e("code",[s._v("Api")]),s._v("的基本信息（这些基本信息会展现在文档页面中）。"),e("code",[s._v("select()")]),s._v("函数返回一个"),e("code",[s._v("ApiSelectorBuilder")]),s._v("实例用来控制哪些接口暴露给"),e("code",[s._v("Swagger")]),s._v("来展现，本例采用指定扫描的包路径来定义，"),e("code",[s._v("Swagger")]),s._v("会扫描该包下所有"),e("code",[s._v("Controller")]),s._v("定义的API，并产生文档内容（除了被"),e("code",[s._v("@ApiIgnore")]),s._v("指定的请求）")])]),s._v(" "),e("h3",{attrs:{id:"添加文档内容"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加文档内容"}},[s._v("#")]),s._v(" 添加文档内容")]),s._v(" "),e("p",[s._v("在完成了上述配置后，其实已经可以生产文档内容，但是这样的文档主要针对请求本身，而描述主要来源于函数等命名产生，对用户并不友好，我们通常需要自己增加一些说明来丰富文档内容。如下所示，我们通过"),e("code",[s._v("@ApiOperation")]),s._v("注解来给API增加说明、通过"),e("code",[s._v("@ApiImplicitParams")]),s._v("、"),e("code",[s._v("@ApiImplicitParam")]),s._v("注解来给参数增加说明")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@ApiOperation(value = "查询", notes = "查询", httpMethod = "GET", response = ResponseEntity.class)\n    @ApiImplicitParams({\n            @ApiImplicitParam(name = "page", value = "page", dataType = "Integer", paramType = "query", defaultValue = "1"),\n            @ApiImplicitParam(name = "pageSize", value = "pageSize", dataType = "Integer", paramType = "query", defaultValue = "10")})\n    @GetMapping("/select")\n    public ResponseEntity select(@RequestParam(defaultValue = "1") int page,\n                                 @RequestParam(defaultValue = "10") int pageSize) {\n        return ResponseEntity.ok(hzsGameSessionService.select(page, pageSize));\n    }\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("hr"),s._v(" "),e("h2",{attrs:{id:"结束语"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#结束语"}},[s._v("#")]),s._v(" 结束语")]),s._v(" "),e("blockquote",[e("p",[s._v("本次搭建Spring Cloud 微服务主要为了练习巩固springcloud方面的知识，还有很多方面的没有使用，如网关，负载均衡，docker部署spring cloud项目等等，尚有待完善。")])]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("微服务项目git地址")]),s._v("：\n"),e("a",{attrs:{href:"https://github.com/cainiao-wu/microservice-spring-cloud.git",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/cainiao-wu/microservice-spring-cloud.git"),e("OutboundLink")],1)]),s._v(" "),e("p",[e("strong",[s._v("服务配置文件git地址：")]),s._v(" "),e("a",{attrs:{href:"https://github.com/cainiao-wu/spring-config.git",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/cainiao-wu/spring-config.git"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);n.default=r.exports}}]);